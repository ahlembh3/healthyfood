{# templates/article/index_admin.html.twig #}
{% extends 'base.html.twig' %}
{% import 'admin_dashboard/_actions.html.twig' as A %}

{% block title %}Articles (admin){% endblock %}
{% block page_title %}Liste des articles{% endblock %}

{% block content %}
  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <caption class="visually-hidden">
        Tableau des articles (ID, titre, validation, + colonnes supplémentaires selon la largeur d’écran) avec actions.
      </caption>

      <thead class="table-light">
      <tr>
        {# Toujours visibles #}
        <th scope="col" style="width:80px;">ID</th>
        <th scope="col">Titre</th>
        <th scope="col">Validation</th>

        {# ≥ md #}
        <th scope="col" class="d-none d-md-table-cell">Auteur</th>

        {# ≥ lg #}
        <th scope="col" class="d-none d-lg-table-cell">Créé le</th>

        {# Colonne Actions compacte, pour éviter les demi-boutons en resize #}
        <th scope="col" class="text-end" style="width:1%; white-space:nowrap;">Actions</th>
      </tr>
      </thead>

      <tbody>
      {% for article in articles %}
        <tr>
          {# Toujours visibles #}
          <th scope="row">{{ article.id }}</th>
          <td class="fw-semibold text-break">{{ article.titre }}</td>
          <td>
            {% if article.validation %}
              <span class="badge text-bg-success">Validé</span>
            {% else %}
              <span class="badge text-bg-warning text-dark">En attente</span>
            {% endif %}
          </td>

          {# ≥ md #}
          <td class="d-none d-md-table-cell">
            {{ article.utilisateur ? article.utilisateur.email : '—' }}
          </td>

          {# ≥ lg #}
          <td class="d-none d-lg-table-cell">
            {{ article.date ? article.date|date('d/m/Y') : '—' }}
          </td>

          {# Actions (macro = icônes en mobile, boutons texte en desktop) #}
          <td class="text-end">
            {{ A.row(
              { href: path('article_show', { id: article.id, from: 'admin' }), label: 'Afficher' },
              { href: path('article_edit', { id: article.id }), label: 'Modifier' }
              # troisième slot (suppression) laissé vide ici
            ) }}
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="6" class="text-center text-muted py-4">Aucun article trouvé.</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <a href="{{ path('article_new') }}" class="btn btn-success mt-3">
    Ajouter un nouvel article
  </a>
{% endblock %}
