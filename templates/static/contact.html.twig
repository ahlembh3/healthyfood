{# templates/static/contact.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Contact - Santé & Nature{% endblock %}
{% block page_title %}Contact{% endblock %}

{% block content %}
    <main id="main" class="contact-page">
        <section class="container-site py-4">

            <nav aria-label="Fil d’Ariane" class="mb-3">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ path('app_home') }}">Accueil</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Contact</li>
                </ol>
            </nav>

            <p class="text-muted">
                Une question, une suggestion ou un retour sur <strong>Santé &amp; Nature</strong> ? Écris-nous via ce formulaire.
            </p>

            <div class="contact-grid">
                <!-- Colonne formulaire -->
                <section class="card h-100">
                    <div class="card-header">Écrivez-nous</div>
                    <div class="card-body">

                        {% set f = contactForm is defined ? contactForm : (form is defined ? form : null) %}

                        {% if f %}
                            {# --- Form Symfony --- #}
                            {% if not f.vars.valid %}
                                <div id="form-errors" class="alert alert-danger" role="alert" tabindex="-1">
                                    {{ form_errors(f) }}
                                </div>
                            {% endif %}

                            {{ form_start(f, {
                                action: path('contact'),
                                method: 'POST',
                                attr: {
                                    novalidate: 'novalidate',
                                    'aria-describedby': 'privacy-note',
                                    class: 'needs-validation',
                                    'data-turbo': 'false'
                                }
                            }) }}
                            {{ form_row(f.name) }}
                            {{ form_row(f.email) }}
                            {{ form_row(f.subject) }}
                            {{ form_row(f.message) }}
                            {{ form_row(f.consent) }}
                            {{ form_rest(f) }}
                            <div class="mt-3 d-flex gap-2">
                                <button class="btn btn-primary" type="submit">Envoyer</button>
                                <a class="btn btn-outline-primary" href="{{ app.request.uri }}">Réinitialiser</a>
                            </div>
                            {{ form_end(f) }}



                        {% else %}
                            {# --- Fallback HTML (si aucun Form Symfony n'est passé) --- #}
                            <form method="post" action="{{ path('contact') }}" class="contact-form"
                                  novalidate aria-describedby="privacy-note" data-turbo="false">
                                <div class="mb-3">
                                    <label for="name" class="form-label required">Votre nom</label>
                                    <input id="name" name="name" type="text" class="form-control" required minlength="2" autocomplete="name">
                                </div>

                                <div class="mb-3">
                                    <label for="email" class="form-label required">Votre e-mail</label>
                                    <input id="email" name="email" type="email" class="form-control" required autocomplete="email" inputmode="email">
                                </div>

                                <div class="mb-3">
                                    <label for="subject" class="form-label required">Sujet</label>
                                    <input id="subject" name="subject" type="text" class="form-control" required>
                                </div>

                                <div class="mb-3">
                                    <label for="message" class="form-label required">Message</label>
                                    <textarea id="message" name="message" rows="6" class="form-control" required minlength="10"></textarea>
                                </div>

                                <div class="form-check mb-3">
                                    <input id="consent" name="consent" class="form-check-input" type="checkbox" required>
                                    <label class="form-check-label" for="consent">
                                        J’accepte que mes données soient traitées pour répondre à ma demande
                                        (voir <a href="{{ path('confidentialite') }}">Confidentialité</a>).
                                    </label>
                                </div>

                                <!-- Honeypot -->
                                <input type="text" name="website" tabindex="-1" autocomplete="off" class="d-none" aria-hidden="true">

                                <!-- CSRF -->
                                <input type="hidden" name="_token" value="{{ csrf_token('contact') }}">

                                <button class="btn btn-primary" type="submit">Envoyer</button>
                            </form>
                        {% endif %}

                        <p id="privacy-note" class="form-text mt-3">
                            Nous répondons sous quelques jours ouvrés. Données traitées selon notre
                            <a href="{{ path('confidentialite') }}">politique de confidentialité</a>.
                        </p>
                    </div>
                </section>

                <!-- Colonne infos -->
                <aside class="card h-100">
                    <div class="card-header">Coordonnées</div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-3">
                            <li class="mb-2">
                                <i class="bi bi-envelope me-2" aria-hidden="true"></i>
                                <a href="mailto:rofranebh1@gmail.com">rofranebh1@gmail.com</a>
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-instagram me-2" aria-hidden="true"></i>
                                <a href="https://instagram.com" target="_blank" rel="noopener noreferrer">Instagram</a>
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-facebook me-2" aria-hidden="true"></i>
                                <a href="https://facebook.com" target="_blank" rel="noopener noreferrer">Facebook</a>
                            </li>
                        </ul>

                        <details class="mt-2">
                            <summary class="fw-semibold">Conseils pour une réponse rapide</summary>
                            <ul class="mt-2">
                                <li>Précise l’URL de la page concernée.</li>
                                <li>Joins le contexte (navigateur, mobile/desktop).</li>
                                <li>Évite les pièces jointes lourdes, préfère un lien.</li>
                            </ul>
                        </details>

                        <p class="small text-muted mt-3 mb-0">
                            Besoin d’accessibilité ? Utilise la touche <kbd>Tab</kbd> pour parcourir les champs, les états d’erreur sont vocalisés.
                        </p>
                    </div>
                </aside>
            </div>
        </section>
    </main>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .contact-grid{ display:grid; gap:1rem; grid-template-columns:1fr; }
        @media (min-width: 992px){
            .contact-grid{ grid-template-columns:minmax(0,2fr) minmax(0,1fr); }
        }
        .contact-page .card{ border:1px solid rgba(0,0,0,.06); }
        .contact-page .card-header{ background:var(--c-vert); color:#fff; }
        .contact-page .form-control, .contact-page textarea{
            background:var(--c-blanccasse); border-color:rgba(0,0,0,.15);
        }
        .required::after{ content:" *"; color:#c00; }
        .breadcrumb{ --bs-breadcrumb-divider:'›'; }
        @media (prefers-reduced-motion:reduce){ .contact-page *{ transition:none !important; } }
    </style>
{% endblock %}
