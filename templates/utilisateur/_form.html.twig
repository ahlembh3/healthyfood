{% set is_edit = form.vars.value.id is defined and form.vars.value.id %}

<div class="d-flex justify-content-center mt-5">
    <div class="card shadow p-4" style="max-width: 500px; width: 100%;">

        <h1 class="text-center mb-4" id="form-title">{{ form_title|default('Créer un compte') }}</h1>

        {{ form_start(form, {'attr': {'aria-labelledby': 'form-title'}}) }}

        <div class="mb-3">
            <label class="form-label" for="{{ form.prenom.vars.id }}">{{ form_label(form.prenom) }}</label>
            <div class="input-group">
                <span class="input-group-text" id="prenom-icon"><i class="bi bi-person"></i></span>
                {{ form_widget(form.prenom, {
                    'attr': {
                        'class': 'form-control',
                        'aria-required': 'true',
                        'aria-describedby': 'prenom-icon ' ~ form.prenom.vars.id ~ '_error'
                    }
                }) }}
            </div>
            <div id="{{ form.prenom.vars.id }}_error" class="text-danger" role="alert">
                {{ form_errors(form.prenom) }}
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label" for="{{ form.nom.vars.id }}">{{ form_label(form.nom) }}</label>
            <div class="input-group">
                <span class="input-group-text" id="nom-icon"><i class="bi bi-person-fill"></i></span>
                {{ form_widget(form.nom, {
                    'attr': {
                        'class': 'form-control',
                        'aria-required': 'true',
                        'aria-describedby': 'nom-icon ' ~ form.nom.vars.id ~ '_error'
                    }
                }) }}
            </div>
            <div id="{{ form.nom.vars.id }}_error" class="text-danger" role="alert">
                {{ form_errors(form.nom) }}
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label" for="{{ form.email.vars.id }}">{{ form_label(form.email) }}</label>
            <div class="input-group">
                <span class="input-group-text" id="email-icon"><i class="bi bi-envelope"></i></span>
                {{ form_widget(form.email, {
                    'attr': {
                        'class': 'form-control',
                        'aria-required': 'true',
                        'aria-describedby': 'email-icon ' ~ form.email.vars.id ~ '_error',
                        'disabled': is_edit
                    }
                }) }}
            </div>
            <div id="{{ form.email.vars.id }}_error" class="text-danger" role="alert">
                {{ form_errors(form.email) }}
            </div>
        </div>

        {% if not is_edit %}
            <div class="mb-3">
                <label class="form-label" for="{{ form.password.vars.id }}">{{ form_label(form.password) }}</label>
                <div class="input-group">
                    <span class="input-group-text" id="password-icon"><i class="bi bi-lock"></i></span>
                    {{ form_widget(form.password, {
                        'attr': {
                            'class': 'form-control',
                            'aria-required': 'true',
                            'aria-describedby': 'password-icon ' ~ form.password.vars.id ~ '_error'
                        }
                    }) }}
                </div>
                <div id="{{ form.password.vars.id }}_error" class="text-danger" role="alert">
                    {{ form_errors(form.password) }}
                </div>
            </div>

            {% if form.confirmPassword is defined %}
                <div class="mb-3">
                    <label class="form-label" for="{{ form.confirmPassword.vars.id }}">{{ form_label(form.confirmPassword) }}</label>
                    <div class="input-group">
                        <span class="input-group-text" id="confirm-icon"><i class="bi bi-lock-fill"></i></span>
                        {{ form_widget(form.confirmPassword, {
                            'attr': {
                                'class': 'form-control',
                                'aria-required': 'true',
                                'aria-describedby': 'confirm-icon ' ~ form.confirmPassword.vars.id ~ '_error'
                            }
                        }) }}
                    </div>
                    <div id="{{ form.confirmPassword.vars.id }}_error" class="text-danger" role="alert">
                        {{ form_errors(form.confirmPassword) }}
                    </div>
                </div>
            {% endif %}
        {% endif %}

        <div class="mb-3">
            <label class="form-label" for="{{ form.preferences.vars.id }}">{{ form_label(form.preferences) }}</label>
            {{ form_widget(form.preferences, {
                'attr': {
                    'class': 'form-control',
                    'rows': '3',
                    'placeholder': 'Décrivez vos préférences...',
                    'aria-describedby': form.preferences.vars.id ~ '_error'
                }
            }) }}
            <div id="{{ form.preferences.vars.id }}_error" class="text-danger" role="alert">
                {{ form_errors(form.preferences) }}
            </div>
        </div>

        <button type="submit" class="btn btn-primary w-100" aria-label="{{ button_label|default('Créer un compte') }}">
            {{ button_label|default("S'inscrire") }}
        </button>

        {{ form_end(form) }}
    </div>
</div>
