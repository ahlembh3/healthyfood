{# Partial de formulaire — inclus par new/edit #}

<div class="card shadow p-4">
  <h2 class="h5 mb-4">{{ form_title|default('Recette') }}</h2>

  {{ form_start(form, {
    attr: {
      novalidate: 'novalidate',
      class: 'needs-validation',
      id: 'recette-form'
    }
  }) }}

  {{ form_errors(form) }}

  <div class="mb-3">
    {{ form_label(form.titre) }}
    {{ form_widget(form.titre, {'attr': {
      class: 'form-control',
      required: 'required',
      minlength: '3',
      maxlength: '255',
      autocomplete: 'off'
    }}) }}
    {{ form_errors(form.titre) }}
  </div>

  <div class="mb-3">
    {{ form_label(form.image) }}
    {{ form_widget(form.image, {
      attr: { class: 'form-control', onchange: 'previewImage(event)', accept: 'image/*' }
    }) }}
    {{ form_errors(form.image) }}

    {# Aperçu image #}
    {% set img = (recette is defined and recette.image) ? recette.image : '' %}
    {% set src = img ? asset((img starts with 'uploads/') ? img : 'uploads/recettes/' ~ img) : '' %}
    <div class="mt-3">
      <p class="text-muted">Aperçu de l'image :</p>
      <img id="imagePreview"
           src="{{ src ?: '#' }}"
           alt="{{ img ? 'Aperçu de ' ~ (recette.titre|default('la recette')) : 'Aperçu de l’image' }}"
           class="img-thumbnail {{ src ? '' : 'd-none' }}"
           data-original-src="{{ src }}">
    </div>
  </div>

  <div class="mb-3">
    {{ form_label(form.description) }}
    {{ form_widget(form.description, {'attr': {'class': 'form-control', 'rows': 3}}) }}
    {{ form_errors(form.description) }}
  </div>

  {# … tes champs ingrédients, instructions (tinymce-editor), temps, difficulté, portions … #}
  {# Garde les mêmes widgets/attrs que dans ta version précédente #}

  <div class="d-flex justify-content-end mt-4">
    <button type="submit" class="btn btn-primary" id="submit-btn">
      {{ button_label|default('Soumettre') }}
    </button>
  </div>

  {{ form_end(form) }}
</div>
